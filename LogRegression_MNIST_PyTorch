{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"LogRegression_MNIST_PyTorch","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyPi3wDyPoRcqBe7KoXJ2bOV"},"kernelspec":{"name":"python3","display_name":"Python 3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"6864673d1b594bab8f78389157fadfcd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ea3c84d11ead4efa9352e48ce513ec01","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3c98fe245c8c4087974c30de9cdfce67","IPY_MODEL_319862b6def749dfaa1c053a0e80ce32"]}},"ea3c84d11ead4efa9352e48ce513ec01":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3c98fe245c8c4087974c30de9cdfce67":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_cdb1caff48124055a66a2edae6a7fd93","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b54f861e4c6c4971bf728e4529d59054"}},"319862b6def749dfaa1c053a0e80ce32":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_98bc1e0c9c9e40f19d40b194b23afe6a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:02&lt;00:00, 4817238.38it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_37abef9b04e549209ba2dc342f10e8e4"}},"cdb1caff48124055a66a2edae6a7fd93":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b54f861e4c6c4971bf728e4529d59054":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"98bc1e0c9c9e40f19d40b194b23afe6a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"37abef9b04e549209ba2dc342f10e8e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7546bc351f7f44479cd3c7b8d843aa12":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5cded078c46e4fd1b2552b708eb18061","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1fafab979bc04a488623b95c63118311","IPY_MODEL_6aa5f0379a554ef6922b5c2d16f1e976"]}},"5cded078c46e4fd1b2552b708eb18061":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1fafab979bc04a488623b95c63118311":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6bdd3ef256914e19ba74d6ffe7845111","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ae9897fd588a4833b40679650d6b7e61"}},"6aa5f0379a554ef6922b5c2d16f1e976":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ce29aa623bc64abb80c2c142f1f53867","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 77415.17it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_69759bc4d7cc4f50b6362f98d174ce8a"}},"6bdd3ef256914e19ba74d6ffe7845111":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ae9897fd588a4833b40679650d6b7e61":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ce29aa623bc64abb80c2c142f1f53867":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"69759bc4d7cc4f50b6362f98d174ce8a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"304a3ee4e8034f828dc1553240f9747a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5b7ca5814568483e9d8e3c7453305b35","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_47465b9f9e154482b93e5060b1ba02c8","IPY_MODEL_38f6f1d97a434f549e2226192a068110"]}},"5b7ca5814568483e9d8e3c7453305b35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"47465b9f9e154482b93e5060b1ba02c8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c868ed7e7b364ab8a7a6dcb373a33d00","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9d4ece95a4ab48779a1dc10776232c9e"}},"38f6f1d97a434f549e2226192a068110":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6e1e5d3a054f4a108788972a0d419652","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:00&lt;00:00, 1800916.45it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cd270502b72b4d079c380be63c517417"}},"c868ed7e7b364ab8a7a6dcb373a33d00":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9d4ece95a4ab48779a1dc10776232c9e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6e1e5d3a054f4a108788972a0d419652":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cd270502b72b4d079c380be63c517417":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"72e68e5ed57f4ca0a7cea8850425091e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_59645b6e1fb545819415d47fab512a57","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2843e8bd6cdb47d9be71fa35e33a843c","IPY_MODEL_c00d3947337b4c2095c5e09900bf44f1"]}},"59645b6e1fb545819415d47fab512a57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2843e8bd6cdb47d9be71fa35e33a843c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5b4755ff8f4945dd90b7a60bed595514","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4143fe757b6c45ebaf17b6b6c2db417a"}},"c00d3947337b4c2095c5e09900bf44f1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_fb1829369add4e04b50b656b444e24c5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:00&lt;00:00, 17361.51it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_94872b5c54dc4acc971b12b5dbd36579"}},"5b4755ff8f4945dd90b7a60bed595514":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"4143fe757b6c45ebaf17b6b6c2db417a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fb1829369add4e04b50b656b444e24c5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"94872b5c54dc4acc971b12b5dbd36579":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"8GskDsOIvhBO","executionInfo":{"status":"ok","timestamp":1606898556397,"user_tz":-300,"elapsed":4914,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["import torch.nn as nn\n","import torch\n","import torchvision\n","from torchvision.datasets import MNIST\n","import torchvision.transforms as transforms\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from torch.utils.data import DataLoader\n","from torch.utils.data import random_split\n","import torch.nn.functional as F"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"id":"2NnrbVvet13J","colab":{"base_uri":"https://localhost:8080/","height":386,"referenced_widgets":["6864673d1b594bab8f78389157fadfcd","ea3c84d11ead4efa9352e48ce513ec01","3c98fe245c8c4087974c30de9cdfce67","319862b6def749dfaa1c053a0e80ce32","cdb1caff48124055a66a2edae6a7fd93","b54f861e4c6c4971bf728e4529d59054","98bc1e0c9c9e40f19d40b194b23afe6a","37abef9b04e549209ba2dc342f10e8e4","7546bc351f7f44479cd3c7b8d843aa12","5cded078c46e4fd1b2552b708eb18061","1fafab979bc04a488623b95c63118311","6aa5f0379a554ef6922b5c2d16f1e976","6bdd3ef256914e19ba74d6ffe7845111","ae9897fd588a4833b40679650d6b7e61","ce29aa623bc64abb80c2c142f1f53867","69759bc4d7cc4f50b6362f98d174ce8a","304a3ee4e8034f828dc1553240f9747a","5b7ca5814568483e9d8e3c7453305b35","47465b9f9e154482b93e5060b1ba02c8","38f6f1d97a434f549e2226192a068110","c868ed7e7b364ab8a7a6dcb373a33d00","9d4ece95a4ab48779a1dc10776232c9e","6e1e5d3a054f4a108788972a0d419652","cd270502b72b4d079c380be63c517417","72e68e5ed57f4ca0a7cea8850425091e","59645b6e1fb545819415d47fab512a57","2843e8bd6cdb47d9be71fa35e33a843c","c00d3947337b4c2095c5e09900bf44f1","5b4755ff8f4945dd90b7a60bed595514","4143fe757b6c45ebaf17b6b6c2db417a","fb1829369add4e04b50b656b444e24c5","94872b5c54dc4acc971b12b5dbd36579"]},"executionInfo":{"status":"ok","timestamp":1606898558329,"user_tz":-300,"elapsed":6839,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"76037992-1026-4490-9d39-d149c5ebe6bf"},"source":["data = MNIST(root='/data',download=True)"],"execution_count":2,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6864673d1b594bab8f78389157fadfcd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /data/MNIST/raw/train-images-idx3-ubyte.gz to /data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to /data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7546bc351f7f44479cd3c7b8d843aa12","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /data/MNIST/raw/train-labels-idx1-ubyte.gz to /data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to /data/MNIST/raw/t10k-images-idx3-ubyte.gz\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"304a3ee4e8034f828dc1553240f9747a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /data/MNIST/raw/t10k-images-idx3-ubyte.gz to /data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to /data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"72e68e5ed57f4ca0a7cea8850425091e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /data/MNIST/raw/t10k-labels-idx1-ubyte.gz to /data/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:480: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"XBeLvORcbYsW","executionInfo":{"status":"ok","timestamp":1606898558331,"user_tz":-300,"elapsed":6839,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["data=MNIST(root='/data',train=True,transform=transforms.ToTensor())"],"execution_count":3,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qpKc6C46dxgh","executionInfo":{"status":"ok","timestamp":1606898558332,"user_tz":-300,"elapsed":6831,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"d462f837-01e0-42d2-cd2f-4c3844f909b7"},"source":["(data[0][0].shape)"],"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 28, 28])"]},"metadata":{"tags":[]},"execution_count":4}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":333},"id":"CjTypv2Zd7oA","executionInfo":{"status":"ok","timestamp":1606898558333,"user_tz":-300,"elapsed":6826,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"4973aa3d-3575-4b1d-d456-d4273becf441"},"source":["imgTensor,label=data[440]\n","plt.imshow(imgTensor[0],cmap='gray')\n","plt.show()\n","print(\"Label: \",label)"],"execution_count":5,"outputs":[{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}},{"output_type":"stream","text":["\n","\n","Label:  0\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dLmP8Hk2eDdk","executionInfo":{"status":"ok","timestamp":1606898558333,"user_tz":-300,"elapsed":6820,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"da525603-0bb3-4d62-c014-39e6ab6c1ed4"},"source":["train_ds,val_ds=random_split(data,[50000,10000])\n","len(train_ds),len(val_ds)"],"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(50000, 10000)"]},"metadata":{"tags":[]},"execution_count":6}]},{"cell_type":"code","metadata":{"id":"kgM1UKUljlnr","executionInfo":{"status":"ok","timestamp":1606898558335,"user_tz":-300,"elapsed":6820,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["train_dl=DataLoader(train_ds,batch_size=100,shuffle=True)\n","val_dl=DataLoader(val_ds,batch_size=100)"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bgr8WW4QjqdO","executionInfo":{"status":"ok","timestamp":1606898558336,"user_tz":-300,"elapsed":6814,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"200b3e99-1376-416f-a76b-322e1538bee9"},"source":["model=nn.Linear(28*28,10)\n","model.parameters()"],"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<generator object Module.parameters at 0x7fe6e76c88e0>"]},"metadata":{"tags":[]},"execution_count":8}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TybsQFLLmOuh","executionInfo":{"status":"ok","timestamp":1606898558337,"user_tz":-300,"elapsed":6809,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"79174fb9-e4c8-46f1-ba9e-3995784f38e5"},"source":["model.weight.shape"],"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([10, 784])"]},"metadata":{"tags":[]},"execution_count":9}]},{"cell_type":"code","metadata":{"id":"KrSdEbvvmR6H","executionInfo":{"status":"ok","timestamp":1606898559546,"user_tz":-300,"elapsed":8016,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["class MyModel(nn.Module):\n","  def __init__(self):\n","    super().__init__()\n","    self.linear=nn.Linear(28*28,10)\n","\n","  def forward(self,xb):\n","    flat_xb=xb.reshape(-1,784)\n","    return self.linear(flat_xb)"],"execution_count":10,"outputs":[]},{"cell_type":"code","metadata":{"id":"917bIU6MoaBC","executionInfo":{"status":"ok","timestamp":1606898559546,"user_tz":-300,"elapsed":8014,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["model=MyModel()"],"execution_count":11,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sbCmma8zogyj","executionInfo":{"status":"ok","timestamp":1606898559547,"user_tz":-300,"elapsed":8009,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"50210a0f-030b-423f-8d23-c59753d5a214"},"source":["model.linear.weight"],"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Parameter containing:\n","tensor([[-1.5802e-03,  8.2196e-03,  1.0846e-02,  ...,  6.6666e-03,\n","          1.8153e-02,  6.2518e-03],\n","        [-2.7130e-02,  2.2139e-06, -1.2176e-02,  ...,  2.2881e-02,\n","         -2.1460e-02, -3.0403e-02],\n","        [ 2.0789e-02,  2.0202e-03, -1.2043e-02,  ..., -2.6971e-02,\n","         -3.4672e-02,  3.4877e-02],\n","        ...,\n","        [ 5.9739e-03, -2.1210e-03,  2.4088e-02,  ...,  1.5363e-02,\n","          3.1563e-02, -2.6406e-02],\n","        [-4.1165e-03, -2.6952e-02,  1.5798e-02,  ..., -5.9166e-03,\n","         -6.6613e-03,  2.0812e-02],\n","        [ 2.3511e-02,  2.5983e-02,  1.1570e-02,  ..., -2.1032e-03,\n","         -2.0392e-02,  2.6739e-02]], requires_grad=True)"]},"metadata":{"tags":[]},"execution_count":12}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"S4fj8u_Go1Lp","executionInfo":{"status":"ok","timestamp":1606898559548,"user_tz":-300,"elapsed":8005,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"fcecd8a3-e56f-42f6-ddb6-9ce865f89b8b"},"source":["for image,label in train_dl:\n","  out=model(image)\n","  print(out[0])\n","  break"],"execution_count":13,"outputs":[{"output_type":"stream","text":["tensor([ 0.1146, -0.1005, -0.1171,  0.3134, -0.0825,  0.1168, -0.2283,  0.3114,\n","        -0.1719, -0.1595], grad_fn=<SelectBackward>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"u6gZTcquvSoW","executionInfo":{"status":"ok","timestamp":1606898559548,"user_tz":-300,"elapsed":8000,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"07a68135-8839-481d-e40f-f4a6532f0265"},"source":["prob=F.softmax(out,dim=1)\n","prob[0]"],"execution_count":14,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([0.1101, 0.0888, 0.0873, 0.1343, 0.0904, 0.1104, 0.0782, 0.1341, 0.0827,\n","        0.0837], grad_fn=<SelectBackward>)"]},"metadata":{"tags":[]},"execution_count":14}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mL9JoGrwycfX","executionInfo":{"status":"ok","timestamp":1606898559549,"user_tz":-300,"elapsed":7995,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"69398d4a-d153-4436-a3fa-e23773c334d7"},"source":["loss_fn=F.cross_entropy #it automatically applies the softmax func at the backend so we dont need to apply it before computing loss\n","loss_fn(out,label) #softmax converts model output to acceptable probability range values and makes sum of all output nodes equal to 1"],"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor(2.3123, grad_fn=<NllLossBackward>)"]},"metadata":{"tags":[]},"execution_count":15}]},{"cell_type":"code","metadata":{"id":"njrYoxFqymMy","executionInfo":{"status":"ok","timestamp":1606898559549,"user_tz":-300,"elapsed":7993,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["lr=1e-5\n","opt =torch.optim.SGD(model.parameters(),lr=lr) #optimizer which is going to take model params and update weights by gradient for whole data, in each iteration, where data is taken in batches\n"],"execution_count":16,"outputs":[]},{"cell_type":"code","metadata":{"id":"6x6kYw7zym--","executionInfo":{"status":"ok","timestamp":1606898559550,"user_tz":-300,"elapsed":7992,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["def accuracy(pred,orig): #we dont need to apply the softmax to the outputs bcz e^x is an increasing func, ad\n","                          #the probability also folows some order i.e. if y1>y2 then e^y1>e^y2 [check softmax formula if confuse!]\n","  _,pred_label = torch.max(pred,dim=1) #get the index of max probability which is our class\n","  return torch.tensor((torch.sum(pred_label==orig)).item() / len(pred_label)) "],"execution_count":17,"outputs":[]},{"cell_type":"code","metadata":{"id":"mITbVi56aLEz","executionInfo":{"status":"ok","timestamp":1606898559550,"user_tz":-300,"elapsed":7990,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["#function to calcualte loss of a batch\n","def loss_batch(model, xb, yb, opt = None, metric = None): \n","  pred=model(xb)\n","  loss=loss_fn(pred,yb)\n","  if opt is not None: #if conditioned b/c we dont need to update model on validation set, and we wanna use this func for eveluating model on val set too\n","    loss.backward() #compute gradients\n","    opt.step() #update weights\n","    opt.zero_grad() #reset gradients\n","  acc=None\n","  if metric is not None:\n","    acc=metric(pred,yb)\n","\n","  return loss.item(),acc,len(xb)\n"],"execution_count":18,"outputs":[]},{"cell_type":"code","metadata":{"id":"kLPDv8j2gjZ2","executionInfo":{"status":"ok","timestamp":1606898559550,"user_tz":-300,"elapsed":7988,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["#function to calcualte avg loss and accuracy over all batches of val set\n","def evaluate(model,loss_fn,val_dl,metric):\n","  with torch.no_grad(): #we dont want to calculate grads, on val set\n","    results = [loss_batch(model,xb,yb,None,metric=metric) for xb,yb in val_dl]\n","    losses,val_acc,nums = zip(*results)\n","    val_set_size=np.sum(nums)\n","    avg_loss = np.sum(np.multiply(losses,nums)) / val_set_size\n","    if metric is not None:\n","      avg_acc = np.sum(np.multiply(val_acc,nums)) / val_set_size\n","\n","    return avg_loss,val_set_size,avg_acc\n"],"execution_count":19,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HrNxRu1Biybo","executionInfo":{"status":"ok","timestamp":1606899146669,"user_tz":-300,"elapsed":1877,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"f674dcde-7ef2-4f8d-b479-4b723e302eb6"},"source":["#A quick sanity check is that we check if the models' performance on train and val set is similar\n","#otherwise we must have messed something up with the val set\n","avg_loss,size,acc_val = evaluate(model,loss_fn,val_dl,accuracy)\n","print(\"avg loss: \",avg_loss)\n","print(\"accuracy on val set: \",acc_val)"],"execution_count":21,"outputs":[{"output_type":"stream","text":["avg loss:  2.3087014508247377\n","accuracy on val set:  0.06859999990090727\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"2_mxQSMrkur5","executionInfo":{"status":"ok","timestamp":1606899149706,"user_tz":-300,"elapsed":1135,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["def fit(epochs,model,loss_fn,opt,train_dl,val_dl,metric=None):\n","  \n","  for epoch in range(epochs):\n","    #Train the model on all the training dataset - 1 itr of GD\n","    results = [loss_batch(model,xb,yb,opt,None) for xb,yb in train_dl]\n","    loss,_,nums = zip(*results)\n","    avg_train_loss= np.sum(np.multiply(loss,nums)) / np.sum(nums)\n","\n","    #Evaluate model on val set\n","    val_loss,_,val_acc=evaluate(model,loss_fn,val_dl,metric)\n","\n","    #Print progress\n","    print(\"EPOCH # \",str(epoch))\n","    print(\"Train Loss: \"+str(avg_train_loss))\n","    print(\"Val Loss: \",str(val_loss))\n","    if metric is not None:\n","      print(\"Val accuracy: \",str(val_acc))\n","\n"],"execution_count":22,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uXsnRneiqI4d","executionInfo":{"status":"ok","timestamp":1606899300772,"user_tz":-300,"elapsed":152011,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"46985eb1-856b-4d4b-aadd-53411cb93023"},"source":["model=MyModel()\n","opt=torch.optim.SGD(model.parameters(),1e-3)\n","fit(30,model,loss_fn,opt,train_dl,val_dl,accuracy)"],"execution_count":23,"outputs":[{"output_type":"stream","text":["EPOCH #  0\n","Train Loss: 2.078315802335739\n","Val Loss:  1.8724951505661012\n","Val accuracy:  0.634300000667572\n","EPOCH #  1\n","Train Loss: 1.706142389535904\n","Val Loss:  1.5665760576725005\n","Val accuracy:  0.7348000007867813\n","EPOCH #  2\n","Train Loss: 1.4509446070194245\n","Val Loss:  1.3541740334033967\n","Val accuracy:  0.7758999967575073\n","EPOCH #  3\n","Train Loss: 1.2720826930999756\n","Val Loss:  1.2026101410388947\n","Val accuracy:  0.802299997806549\n","EPOCH #  4\n","Train Loss: 1.1426279183626176\n","Val Loss:  1.0905357420444488\n","Val accuracy:  0.8164999961853028\n","EPOCH #  5\n","Train Loss: 1.0456334989070892\n","Val Loss:  1.005048069357872\n","Val accuracy:  0.8265999978780747\n","EPOCH #  6\n","Train Loss: 0.9705780152082443\n","Val Loss:  0.9378526365756988\n","Val accuracy:  0.8322999972105026\n","EPOCH #  7\n","Train Loss: 0.9108829567432404\n","Val Loss:  0.8837628591060639\n","Val accuracy:  0.8362999975681304\n","EPOCH #  8\n","Train Loss: 0.8622733947038651\n","Val Loss:  0.839252033829689\n","Val accuracy:  0.8406999969482422\n","EPOCH #  9\n","Train Loss: 0.8218756158351899\n","Val Loss:  0.8019723868370057\n","Val accuracy:  0.8455999946594238\n","EPOCH #  10\n","Train Loss: 0.78775903069973\n","Val Loss:  0.7702270990610123\n","Val accuracy:  0.8480999958515167\n","EPOCH #  11\n","Train Loss: 0.7585234680175781\n","Val Loss:  0.7427331906557083\n","Val accuracy:  0.8500999981164932\n","EPOCH #  12\n","Train Loss: 0.7331638208627701\n","Val Loss:  0.7188363516330719\n","Val accuracy:  0.8519999992847442\n","EPOCH #  13\n","Train Loss: 0.7109196121692658\n","Val Loss:  0.6977790808677673\n","Val accuracy:  0.8537999993562698\n","EPOCH #  14\n","Train Loss: 0.6912479339838028\n","Val Loss:  0.6791345632076263\n","Val accuracy:  0.8552000010013581\n","EPOCH #  15\n","Train Loss: 0.6736929380893707\n","Val Loss:  0.6623571211099625\n","Val accuracy:  0.8563999998569488\n","EPOCH #  16\n","Train Loss: 0.6579251255989075\n","Val Loss:  0.6473807847499847\n","Val accuracy:  0.858500002026558\n","EPOCH #  17\n","Train Loss: 0.6436607368588447\n","Val Loss:  0.6336634257435798\n","Val accuracy:  0.85950000166893\n","EPOCH #  18\n","Train Loss: 0.6306977025866508\n","Val Loss:  0.6211135691404343\n","Val accuracy:  0.861200001835823\n","EPOCH #  19\n","Train Loss: 0.6188511987924575\n","Val Loss:  0.6097941517829895\n","Val accuracy:  0.8621000009775162\n","EPOCH #  20\n","Train Loss: 0.6079688361883163\n","Val Loss:  0.5992515751719475\n","Val accuracy:  0.8628000003099442\n","EPOCH #  21\n","Train Loss: 0.5979406942129135\n","Val Loss:  0.589597130715847\n","Val accuracy:  0.8635999995470047\n","EPOCH #  22\n","Train Loss: 0.5886535013914108\n","Val Loss:  0.5805821999907493\n","Val accuracy:  0.8642999994754791\n","EPOCH #  23\n","Train Loss: 0.5800291203260421\n","Val Loss:  0.5722121644020081\n","Val accuracy:  0.8653999996185303\n","EPOCH #  24\n","Train Loss: 0.572000046133995\n","Val Loss:  0.5644306349754333\n","Val accuracy:  0.8667999994754791\n","EPOCH #  25\n","Train Loss: 0.564486420750618\n","Val Loss:  0.5571595674753189\n","Val accuracy:  0.867600000500679\n","EPOCH #  26\n","Train Loss: 0.5574597256183624\n","Val Loss:  0.5503448390960693\n","Val accuracy:  0.8683999997377395\n","EPOCH #  27\n","Train Loss: 0.5508528206944465\n","Val Loss:  0.5439195847511291\n","Val accuracy:  0.8686000001430512\n","EPOCH #  28\n","Train Loss: 0.5446321367621422\n","Val Loss:  0.5378715848922729\n","Val accuracy:  0.8691999995708466\n","EPOCH #  29\n","Train Loss: 0.5387589969635009\n","Val Loss:  0.5321829760074616\n","Val accuracy:  0.8704000008106232\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":282},"id":"O_H3V_Hwq1N8","executionInfo":{"status":"ok","timestamp":1606899300776,"user_tz":-300,"elapsed":151848,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"57ed443c-fb4b-4873-c871-deee6fff53f6"},"source":["#Testing the trained model\n","test_data=MNIST(root='/data',train=False,transform=transforms.ToTensor())\n","img,label = test_data[0]\n","plt.imshow(img[0],cmap='gray')\n","print(\"Label: \",label)"],"execution_count":24,"outputs":[{"output_type":"stream","text":["Label:  7\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"code","metadata":{"id":"mxkTtHXu2VRK","executionInfo":{"status":"ok","timestamp":1606899300777,"user_tz":-300,"elapsed":151679,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["#Prediction function\n","def pred(img,model):\n","  xb = img.unsqueeze(0)\n","  yb = model(xb)\n","  _,pred=torch.max(yb,dim=1)\n","  return pred[0].item()\n"],"execution_count":25,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":282},"id":"U9uPXikS2_Pm","executionInfo":{"status":"ok","timestamp":1606899300777,"user_tz":-300,"elapsed":151441,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"27191d60-8085-4852-b96a-d747d28bd477"},"source":["#Test model\n","sample=99\n","img,label = test_data[sample]\n","plt.imshow(img[0],cmap='gray')\n","print(\"Original label: \",str(label),\" Predicted: \",str(pred(img,model)))\n"],"execution_count":26,"outputs":[{"output_type":"stream","text":["Original label:  9  Predicted:  9\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAPsAAAD4CAYAAAAq5pAIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAANyUlEQVR4nO3df4xU9bnH8c+DFyKxqHD1bgjF0lt/pdZUbggxucTUVOqPSKAaSfmjYmy6RUttE2Lc2GiNP5Lmxhb9i7gE0m3DtSFpKUSbSxFJvP0HWZUrKFIXghayspeYCI2aCvv0jz02K875znDOmTmzPO9XspmZ88w558mED+fM+TFfc3cBOPtNqrsBAJ1B2IEgCDsQBGEHgiDsQBD/0smVmRmH/oE2c3drNL3Ult3MbjKz/WY2ZGZ9ZZYFoL2s6Hl2MztH0l8kLZR0WNIuScvc/c3EPGzZgTZrx5Z9vqQhdz/o7n+X9FtJi0ssD0AblQn7LEl/Hff6cDbtM8ys18wGzWywxLoAlNT2A3Tu3i+pX2I3HqhTmS37EUmzx73+YjYNQBcqE/Zdki4zsy+b2RRJ35G0pZq2AFSt8G68u580s5WStko6R9J6d3+jss4AVKrwqbdCK+M7O9B2bbmoBsDEQdiBIAg7EARhB4Ig7EAQhB0IgrADQRB2IAjCDgRB2IEgCDsQBGEHgiDsQBCEHQiCsANBEHYgCMIOBEHYgSAIOxAEYQeCIOxAEIQdCIKwA0EQdiAIwg4EQdiBIAg7EARhB4Ig7EAQhB0IovD47JJkZocknZB0StJJd59XRVMAqlcq7Jnr3f1YBcsB0EbsxgNBlA27S/qTmb1iZr2N3mBmvWY2aGaDJdcFoARz9+Izm81y9yNm9m+Stkn6kbu/lHh/8ZUBaIm7W6Pppbbs7n4kexyRtEnS/DLLA9A+hcNuZueZ2bRPn0v6lqS9VTUGoFpljsb3SNpkZp8u57/d/X8q6SqYSZPS/+deeumlyfrtt9+eW3vooYeS806dOjVZb+bDDz9M1h9//PHc2urVq5Pzfvzxx4V6QmOFw+7uByV9vcJeALQRp96AIAg7EARhB4Ig7EAQhB0IotQVdGe8sqBX0F177bXJel9fX7K+aNGiKtvpGuvXr0/WV6xYkayfOnWqynbOGm25gg7AxEHYgSAIOxAEYQeCIOxAEIQdCIKwA0Fwnr0C2W2+uV588cVk/brrrquynTPS7Fz16Ohosj558uQq2/mMlStXJutr1qxp27onMs6zA8ERdiAIwg4EQdiBIAg7EARhB4Ig7EAQVQzsGELqXHqzn2suex692U8qHzhwILe2bt265LzPP/98sj40NJSsr127Nlm/++67k/WU2267LVnfsGFDsn78+PHC6z4bsWUHgiDsQBCEHQiCsANBEHYgCMIOBEHYgSC4n71FU6ZMya199NFHpZbd7J7yp59+Olm///77S62/jAsuuCBZ37NnT25t1qxZpdb9wAMPJOtPPvlkqeVPVIXvZzez9WY2YmZ7x02bYWbbzOzt7HF6lc0CqF4ru/G/knTTadP6JG1398skbc9eA+hiTcPu7i9Jev+0yYslDWTPByQtqbgvABUrem18j7sPZ8/fk9ST90Yz65XUW3A9ACpS+kYYd/fUgTd375fUL03sA3TARFf01NtRM5spSdnjSHUtAWiHomHfIml59ny5pM3VtAOgXZqeZzezZyV9Q9JFko5K+pmkP0jaKOkSSe9IWurupx/Ea7SsCbsb387z7E899VSyvmrVqlLLr9Ott96aW9u8udw24uDBg8l66ncEhoeHc2sTXd559qbf2d19WU7pm6U6AtBRXC4LBEHYgSAIOxAEYQeCIOxAENzi2qKbb745t/bcc88l5/3ggw+S9SuvvDJZHxnp3muWzj///GT9tddey63NmTOn4m4+65lnnsmt3XvvvW1dd50YshkIjrADQRB2IAjCDgRB2IEgCDsQBGEHgmDI5hY1Oxee0uynojt5rcOZanYufGBgIFlv97n0lCVL8n8a8b777kvOe/LkyarbqR1bdiAIwg4EQdiBIAg7EARhB4Ig7EAQhB0IgvPsLdq1a1fheWfMmJGs33PPPcn6o48+Wnjdkyal/z+//PLLk/XHHnssWV+wYMEZ99QpW7duza01u/bhbMSWHQiCsANBEHYgCMIOBEHYgSAIOxAEYQeC4Dx7i15++eW2LfuOO+5I1t99991kfd++fbm1FStWJOe98847k/VuduLEiWR948aNubVu/g2Bdmm6ZTez9WY2YmZ7x017xMyOmNnu7O+W9rYJoKxWduN/JemmBtNXu/s12d8fq20LQNWaht3dX5L0fgd6AdBGZQ7QrTSz17Pd/Ol5bzKzXjMbNLPB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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"code","metadata":{"id":"vs4NWcMm3WP4","executionInfo":{"status":"ok","timestamp":1606899483786,"user_tz":-300,"elapsed":1411,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}}},"source":["#Save the model\n","torch.save(model.state_dict(),'TrainedModels/mnist-logreg.pth')"],"execution_count":32,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6kTvhGkx3ln6","executionInfo":{"status":"ok","timestamp":1606899532584,"user_tz":-300,"elapsed":1027,"user":{"displayName":"momil ijaz","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgjmsCSPmSp613JqX9huSu9VVev2QRWUyhkhlqPhw=s64","userId":"08940251211294344882"}},"outputId":"ffa7cec4-6ee5-43a9-f2cb-125413d1bccc"},"source":["#Retreivgin the model\n","model2 = MyModel()\n","model2.load_state_dict(torch.load('TrainedModels/mnist-logreg.pth'))"],"execution_count":37,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":37}]},{"cell_type":"code","metadata":{"id":"mIc54Zfjq7bQ"},"source":[""],"execution_count":null,"outputs":[]}]}